<div class="typeContainer" [class.hasShadow]='this.currentGen===this.typeOfGen.newWorksheet'>
  <div class="selType"
(click)='this.currentGen=this.typeOfGen.newWorksheet'>ğŸ“‹{{ptsService.pts?.GenWorksheetPage.genNewSheet||"ç”¢ç”Ÿæ–°è¡¨å–®"}}</div>
  <div *ngIf='this.currentGen===this.typeOfGen.newWorksheet' [@fadeInOut]>
    <mat-form-field class="inline">
      <input matInput 
      [placeholder]="ptsService.pts?.GenWorksheetPage.newNameForm||'æ–°è¡¨å–®åç¨±å½¢å¼ï¼›'" 
      [value]="this.gsettings.eachSheet+'   â¡   '+this.newSheetName"
      disabled='disabled'/>
    </mat-form-field>
    <div>
      <mat-form-field class="block">
        <input matInput 
        [placeholder]="ptsService.pts?.GenWorksheetPage.year||'å­¸å¹´ï¼š'" 
        [value]="this.gsettings.new_year"
        (input)='this.gsettings.new_year=$event.target.value;this.updateNewSheetName()'/>
      </mat-form-field>
      <mat-form-field class="block">
        <input matInput 
        [placeholder]="ptsService.pts?.GenWorksheetPage.sem||'å­¸æœŸï¼š'" 
        [value]="this.gsettings.new_sem"
        (input)='this.gsettings.new_sem=$event.target.value;this.updateNewSheetName()'/>
      </mat-form-field>
      <mat-form-field class="block">
        <input matInput 
        [placeholder]="ptsService.pts?.GenWorksheetPage.times||'ç¬¬å¹¾æ¬¡ï¼š'" 
        [value]="this.gsettings.new_times"
        (input)='this.gsettings.new_times=$event.target.value;this.updateNewSheetName()'/>
      </mat-form-field>
      <button mat-raised-button (click)='genNewSheet()'>{{ptsService.pts?.GenWorksheetPage.genNewSheet||"ç”¢ç”Ÿæ–°è¡¨å–®"}}</button>
    </div>
  </div>
</div>
<div class="typeContainer" [class.hasShadow]='this.currentGen===this.typeOfGen.newCharts'>
  <div class="selType"
  (click)='this.currentGen=this.typeOfGen.newCharts'>ğŸ“ˆ{{ptsService.pts?.GenWorksheetPage.genNewChartSheet||"ç”¢ç”Ÿæ–°åœ–è¡¨"}}</div>
  <div *ngIf='this.currentGen===this.typeOfGen.newCharts' [@fadeInOut]>
    <div class="mainSetForChart">
      <div class="boxLabel">{{ptsService.pts?.GenWorksheetPage.base||"ä¸»è¦"}}</div>
      <div>{{ptsService.pts?.GenWorksheetPage.compare||"æ¯”è¼ƒ"}}</div>
      <mat-form-field class="col2">
        <mat-select [(ngModel)]="thisTimeGrade" [placeholder]="ptsService.pts?.GenWorksheetPage.thisTime||'é€™ä¸€æ¬¡'">
          <mat-option *ngFor="let grade of gradesInfo" [value]="grade" (onSelectionChange)="this.updateGrades()">{{grade.thisSheetName}}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field class="col2">
        <mat-select [(ngModel)]="previousTimeGrade" [placeholder]="ptsService.pts?.GenWorksheetPage.previousTime||'å‰ä¸€æ¬¡'">
          <mat-option *ngFor="let grade of gradesInfo" [value]="grade" (onSelectionChange)="this.updateGrades()">{{grade.thisSheetName}}</mat-option>
        </mat-select>
      </mat-form-field>
      <div>
        <span class="col2">{{ptsService.pts?.GenWorksheetPage.chartWhichCourse||"ä½œåœ–å“ªå€‹æˆç¸¾ï¼Ÿ"}}</span>
        <mat-form-field class="col2">
          <mat-select [(ngModel)]="chosenGrade" [placeholder]="ptsService.pts?.GenWorksheetPage.course||'æˆç¸¾'">
            <mat-option *ngFor="let grade of grades" [value]="grade">{{grade.name}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <input matInput [placeholder]="ptsService.pts?.GenWorksheetPage.chartSheetName||'è¼¸å‡ºåœ–è¡¨çš„è¡¨å–®åç¨±'" 
          [value]="this.gsettings.chartSheetName"
          (input)="this.gsettings.chartSheetName = $event.target.value"/>
        </mat-form-field>
        <button mat-raised-button (click)="genChartSheet()">{{ptsService.pts?.GenWorksheetPage.output||"è¼¸å‡º"}}</button>
      </div>
    </div>
    <div class="detailSetForChart">
      <div class="boxLabel">{{ptsService.pts?.GenWorksheetPage.visualize||"è¦–è¦ºåŒ–"}}</div>
      <div>
        <mat-form-field class="col2">
          <input matInput [placeholder]="ptsService.pts?.GenWorksheetPage.sen4SpecialCell||'ç‰¹æ®Šæ¬„ä½æ–‡å­—'"
          [value]="this.gsettings.stSpecial"
          (input)="this.updateStSpecial($event.target.value)"/>
        </mat-form-field>
        <button mat-raised-button (click)="this.updateSpecialWords()" class="col2">{{ptsService.pts?.GenWorksheetPage.useIt||"å¥—ç”¨æ­¤æ–‡å­—"}}</button>
      </div>
      <div class="detailSetForChart">
        <div>
          <span [innerHTML]="(ptsService.pts?.GenWorksheetPage.tutorial||'ä½¿ç”¨ä»¥ä¸‹çš„æŒ‰éˆ•å‰ï¼Œè«‹å…ˆå°è¡¨å–®{0}è£¡çš„ç¬¬ä¸€ä½å­¸ç”Ÿçš„è¡¨æ ¼é€²è¡Œè¨­å®šï¼Œå¦‚å¯¬ã€é«˜ã€å­—é«”ã€é¡è‰²ç­‰ï¼Œä½†è«‹ä¸è¦åˆªæ¸›ä»»ä½•æ¬„æˆ–åˆ—').replace('{0}',this.gsettings.chartSheetName)"></span></div>
          <button mat-raised-button (click)="this.applyRowHeight()" class="col2 col2-1">{{ptsService.pts?.GenWorksheetPage.justHeight||"åƒ…å¥—ç”¨åˆ—é«˜"}}</button>
          <button mat-raised-button (click)="this.applyFormat()" class="col2 col2-2">{{ptsService.pts?.GenWorksheetPage.forAll||"å¥—ç”¨å…¨éƒ¨(å¾ˆæ…¢)"}}</button>
          <div class="note" [innerHTML]="ptsService.pts?.GenWorksheetPage.visNote||'æ³¨æ„ï¼šæ ¼ç·šå…¶å¯¦ä¹Ÿå¯å¥—ç”¨ï¼Œä¸éï¼Œåœ¨ç•«è‡ªå·±æƒ³è¦çš„æ ¼ç·šå‰ï¼Œè«‹å…ˆå°‡é è¨­çš„æ‰€æœ‰æ ¼ç·šæ´—æ‰å¾Œå†é‡æ–°é–‹å§‹ç•«æ ¼ç·šã€‚æ€éº¼ä¸€æ¬¡å…¨æ´—æ‰ï¼Ÿå¾ˆç°¡å–®ã€‚åªè¦å…¨é¸(Ctrl-A)æ•´å€‹è¡¨æ ¼ï¼Œç„¶å¾Œé¸å¸¸ç”¨=>ç„¡æ¡†ç·šå³å¯ã€‚'">
          </div>
        </div>
      </div>
    </div>
  </div>
  